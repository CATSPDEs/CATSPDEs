(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15841,        324]
NotebookOptionsPosition[     15329,        303]
NotebookOutlinePosition[     15706,        319]
CellTagsIndexPosition[     15663,        316]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"set", " ", "your", " ", "home", " ", "directory"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.668165349926426*^9, 3.6681653768637767`*^9}, {
   3.668165461523141*^9, 3.6681655139834633`*^9}, 3.6681656071284866`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"import", " ", "nodes", " ", "and", " ", "triangles"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nodes", "=", 
     RowBox[{"Import", "[", 
      RowBox[{"\"\<nOld.dat\>\"", ",", "\"\<Table\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Mathematica", " ", "counts", " ", "from", " ", "1", " ", "not", " ", 
     "0"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"triangles", "=", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"\"\<tOld.dat\>\"", ",", "\"\<Table\>\""}], "]"}], "+", 
      "1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"redTriangles", " ", "=", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"\"\<tRed.dat\>\"", ",", "\"\<List\>\""}], "]"}], "+", "1"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"elements", "=", 
     RowBox[{"Triangle", "/@", "triangles"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"map", " ", 
     RowBox[{"Triangles", "[", "]"}], " ", "at", " ", "each", " ", "element", 
     " ", "of", " ", "list", " ", "of", " ", "triangles"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"elements", "=", 
     RowBox[{"MapAt", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"#", ",", "Red"}], "]"}], "&"}], ",", "elements", ",", 
       RowBox[{"List", "/@", "redTriangles"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[ScriptCapitalK]", "=", 
     RowBox[{"MeshRegion", "[", 
      RowBox[{"nodes", ",", "elements"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6681648107786846`*^9, 3.668164878812313*^9}, {
   3.6681649190735836`*^9, 3.6681649394584446`*^9}, {3.668165245323753*^9, 
   3.66816525150686*^9}, {3.6681653482091556`*^9, 3.668165373132949*^9}, {
   3.6681656275523605`*^9, 3.6681656793529406`*^9}, {3.6681657857356853`*^9, 
   3.6681658089093013`*^9}, {3.668583590914275*^9, 3.668583647828843*^9}, {
   3.6685837935670595`*^9, 3.6685838420367928`*^9}, {3.668583888578088*^9, 
   3.668583971238465*^9}, {3.668584008603407*^9, 3.6685841324663725`*^9}, {
   3.668584175297161*^9, 3.668584206118619*^9}, {3.6685843174583855`*^9, 
   3.6685843234523487`*^9}, {3.668584384992618*^9, 3.6685843881154013`*^9}, {
   3.6685844247396474`*^9, 3.6685844584099855`*^9}, {3.668584558159877*^9, 
   3.668584738433853*^9}, {3.6685848114347744`*^9, 3.6685848479297175`*^9}, {
   3.6685850952781367`*^9, 3.668585138217016*^9}, {3.668585247150592*^9, 
   3.6685852697427006`*^9}, {3.668585315380999*^9, 3.668585315711151*^9}, {
   3.66858537161535*^9, 3.6685853847242546`*^9}, {3.6685855123760276`*^9, 
   3.668585531067195*^9}, {3.668585693227211*^9, 3.6685857148056636`*^9}, {
   3.66858575247922*^9, 3.6685857611384835`*^9}, {3.6685858347875476`*^9, 
   3.668586040778804*^9}, {3.6685861018887634`*^9, 3.6685861056828485`*^9}, {
   3.6685861366807165`*^9, 3.66858613736767*^9}, {3.668586186324027*^9, 
   3.668586189390504*^9}, {3.6685862205466185`*^9, 3.668586249108491*^9}, {
   3.6685863660887117`*^9, 3.668586367868973*^9}, {3.6685864018563833`*^9, 
   3.668586402735545*^9}, 3.6685866046013317`*^9, 3.668586642109547*^9, {
   3.668589547248581*^9, 3.6685895786319156`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"refined", " ", "mesh"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nodes", "=", 
     RowBox[{"Import", "[", 
      RowBox[{"\"\<nNew.dat\>\"", ",", "\"\<Table\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"triangles", "=", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"\"\<tNew.dat\>\"", ",", "\"\<Table\>\""}], "]"}], "+", 
      "1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[ScriptCapitalK]", "refined"], "=", 
     RowBox[{"MeshRegion", "[", 
      RowBox[{"nodes", ",", 
       RowBox[{"Line", "[", "triangles", "]"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6685863387512293`*^9, 3.668586378086691*^9}, {
   3.668586437482833*^9, 3.6685864823368993`*^9}, 3.668586612580922*^9, {
   3.6685866455781136`*^9, 3.6685866490249815`*^9}, {3.668586681587144*^9, 
   3.6685866871254654`*^9}, {3.6685891266473894`*^9, 3.66858921284379*^9}, {
   3.6685892864248304`*^9, 3.668589300942192*^9}, {3.668589362648345*^9, 
   3.668589363974553*^9}, {3.668589494576367*^9, 3.6685895364891768`*^9}, {
   3.668589674781836*^9, 3.6685896846435966`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{" ", "let", "\[CloseCurlyQuote]"}], "s", " ", "plot", " ", "old", 
    " ", "and", " ", "refined", " ", "triangulations"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"\[ScriptCapitalK]", "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{"\[ScriptCapitalK]", ",", 
     SubscriptBox["\[ScriptCapitalK]", "refined"]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.668165682378528*^9, 3.668165781016464*^9}, {
   3.668165880431182*^9, 3.66816588597805*^9}, {3.6681659170408287`*^9, 
   3.6681659907697153`*^9}, {3.668166041126202*^9, 3.6681660560099936`*^9}, {
   3.6681663667668114`*^9, 3.6681663676958156`*^9}, {3.668582999021781*^9, 
   3.668583007388589*^9}, {3.668583055458533*^9, 3.6685830700931096`*^9}, {
   3.6685832224079266`*^9, 3.6685832385750923`*^9}, {3.6685841605878315`*^9, 
   3.6685841654524336`*^9}, {3.668586259913072*^9, 3.668586262896628*^9}, 
   3.6685862992557755`*^9, {3.6685864953406487`*^9, 3.668586615420957*^9}, {
   3.668586693818514*^9, 3.6685867318753815`*^9}, {3.668589230860963*^9, 
   3.6685892414763145`*^9}, {3.668589466901947*^9, 3.6685894778041844`*^9}, {
   3.668589690171559*^9, 3.6685896948426027`*^9}, {3.6686049659174557`*^9, 
   3.668604979690107*^9}}],

Cell[BoxData[
 GraphicsBox[
  TagBox[
   DynamicModuleBox[{Typeset`mesh = HoldComplete[
     MeshRegion[CompressedData["
1:eJxdkMEJgDAUQ4t0DC9Oks4gFO+CZ/cSd2iXcImePHvSWlL4CZTyIJ8HmdZ9
3gbn3Pi9+rf43P47nUfNk8g/HqWzM2G/QO5h+z4I5yXWXN1Hpo9Mk+0XyD1s
3wfhHBuDPjJ9ZPpsv0DuYfs+CHNPyJ7dR5Y9IXtC9uw+8gtTxZ9u
      "], {
       Polygon[{{1, 2, 8}, {2, 9, 8}, {2, 3, 9}, {3, 10, 9}, {3, 4, 10}, {4, 
        11, 10}, {4, 5, 11}, {5, 12, 11}, {5, 6, 12}, {6, 13, 12}, {6, 7, 
        13}, {7, 14, 13}, {8, 9, 15}, {9, 16, 15}, {9, 10, 16}, {10, 17, 
        16}, {10, 11, 17}, {11, 18, 17}, {11, 12, 18}, {12, 19, 18}, {12, 13, 
        19}, {13, 20, 19}, {13, 14, 20}, {14, 21, 20}, {15, 16, 22}, {16, 23, 
        22}, {16, 17, 23}, {17, 24, 23}, {17, 18, 24}, {18, 25, 24}, {18, 19, 
        25}, {19, 26, 25}, {19, 20, 26}, {20, 27, 26}, {20, 21, 27}, {21, 28, 
        27}}]}, Properties -> {{
         2, {10, 28, 34, 20, 11, 1, 24, 9, 30, 36, 35, 26}} -> (MeshCellStyle -> {
           RGBColor[1, 0, 0], 
           RGBColor[1, 0, 0], 
           RGBColor[1, 0, 0], 
           RGBColor[1, 0, 0], 
           RGBColor[1, 0, 0], 
           RGBColor[1, 0, 0], 
           RGBColor[1, 0, 0], 
           RGBColor[1, 0, 0], 
           RGBColor[1, 0, 0], 
           RGBColor[1, 0, 0], 
           RGBColor[1, 0, 0], 
           RGBColor[1, 0, 0]}), {2, Default} -> (MeshCellStyle -> Automatic)},
       Method -> {
       "EliminateUnusedCoordinates" -> True, "DeleteDuplicateCoordinates" -> 
        Automatic, "VertexAlias" -> Identity, "CheckOrientation" -> True, 
        "CoplanarityTolerance" -> Automatic, "CheckIntersections" -> 
        Automatic, "BoundaryNesting" -> Automatic, "SeparateBoundaries" -> 
        False, "PropagateMarkers" -> True, "Hash" -> 5773558500174753591}]]}, 
    TagBox[GraphicsComplexBox[CompressedData["
1:eJxdkMEJgDAUQ4t0DC9Oks4gFO+CZ/cSd2iXcImePHvSWlL4CZTyIJ8HmdZ9
3gbn3Pi9+rf43P47nUfNk8g/HqWzM2G/QO5h+z4I5yXWXN1Hpo9Mk+0XyD1s
3wfhHBuDPjJ9ZPpsv0DuYfs+CHNPyJ7dR5Y9IXtC9uw+8gtTxZ9u
      "], 
      {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
       PolygonBox[{{1, 2, 8}, {2, 9, 8}, {2, 3, 9}, {3, 10, 9}, {3, 4, 10}, {
        4, 11, 10}, {4, 5, 11}, {5, 12, 11}, {5, 6, 12}, {6, 13, 12}, {6, 7, 
        13}, {7, 14, 13}, {8, 9, 15}, {9, 16, 15}, {9, 10, 16}, {10, 17, 
        16}, {10, 11, 17}, {11, 18, 17}, {11, 12, 18}, {12, 19, 18}, {12, 13, 
        19}, {13, 20, 19}, {13, 14, 20}, {14, 21, 20}, {15, 16, 22}, {16, 23, 
        22}, {16, 17, 23}, {17, 24, 23}, {17, 18, 24}, {18, 25, 24}, {18, 19, 
        25}, {19, 26, 25}, {19, 20, 26}, {20, 27, 26}, {20, 21, 27}, {21, 28, 
        27}}], 
       {RGBColor[1, 0, 0], 
        PolygonBox[{{1, 2, 8}, {5, 6, 12}, {6, 13, 12}, {6, 7, 13}, {12, 19, 
         18}, {14, 21, 20}, {16, 23, 22}, {17, 24, 23}, {18, 25, 24}, {20, 27,
          26}, {20, 21, 27}, {21, 28, 27}}]}}],
     MouseAppearanceTag["LinkHand"]],
    AllowKernelInitialization->False],
   "MeshGraphics",
   AutoDelete->True,
   Editable->False,
   Selectable->False],
  DefaultBaseStyle->{
   "Graphics", FrontEnd`GraphicsHighlightColor -> Hue[0.1, 1, 0.7]},
  ImageSize->{446.7333333333337, Automatic}]], "Output",
 CellChangeTimes->{
  3.668586734703586*^9, 3.668588320097186*^9, 3.668588896380887*^9, 
   3.6685891745539265`*^9, {3.6685892190158353`*^9, 3.6685892435487347`*^9}, {
   3.668589289975683*^9, 3.668589306503337*^9}, {3.6685894824637585`*^9, 
   3.668589538270357*^9}, 3.6685895864433756`*^9, 3.668589697093961*^9, 
   3.668600909003481*^9, 3.6686013458542585`*^9, 3.668601770927331*^9, 
   3.6686030951639156`*^9, 3.668603763781337*^9, 3.668604982288989*^9}],

Cell[BoxData[
 GraphicsBox[{GraphicsComplexBox[CompressedData["
1:eJxdkMEJgDAUQ4t0DC9Oks4gFO+CZ/cSd2iXcImePHvSWlL4CZTyIJ8HmdZ9
3gbn3Pi9+rf43P47nUfNk8g/HqWzM2G/QO5h+z4I5yXWXN1Hpo9Mk+0XyD1s
3wfhHBuDPjJ9ZPpsv0DuYfs+CHNPyJ7dR5Y9IXtC9uw+8gtTxZ9u
    "], 
    {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
     PolygonBox[{{1, 2, 8}, {2, 9, 8}, {2, 3, 9}, {3, 10, 9}, {3, 4, 10}, {4, 
      11, 10}, {4, 5, 11}, {5, 12, 11}, {5, 6, 12}, {6, 13, 12}, {6, 7, 13}, {
      7, 14, 13}, {8, 9, 15}, {9, 16, 15}, {9, 10, 16}, {10, 17, 16}, {10, 11,
       17}, {11, 18, 17}, {11, 12, 18}, {12, 19, 18}, {12, 13, 19}, {13, 20, 
      19}, {13, 14, 20}, {14, 21, 20}, {15, 16, 22}, {16, 23, 22}, {16, 17, 
      23}, {17, 24, 23}, {17, 18, 24}, {18, 25, 24}, {18, 19, 25}, {19, 26, 
      25}, {19, 20, 26}, {20, 27, 26}, {20, 21, 27}, {21, 28, 27}}], 
     {RGBColor[1, 0, 0], 
      PolygonBox[{{1, 2, 8}, {5, 6, 12}, {6, 13, 12}, {6, 7, 13}, {12, 19, 
       18}, {14, 21, 20}, {16, 23, 22}, {17, 24, 23}, {18, 25, 24}, {20, 27, 
       26}, {20, 21, 27}, {21, 28, 27}}]}}], 
   GraphicsComplexBox[CompressedData["
1:eJxdkrENwjAURC3kRZjkMgNSoEeiZpWsQWCESPESNPRuXKVwRQWJuY/+WYqi
J9//53/2/nw9XHYhBHy/9d9WTO2/zI9xXe+ZvOFYjINb1BdIPbw+dsLp1K/r
aX5k+pHp5PUFUg+vj51w6huDfmT6kenn9QVSD6+PnTDzhORpfmTJE5InJE/z
8/1COm7+2eYlc9/nX8F9+vn6CtVr3tK/U2b9feOX5UVu+8Pk5x0m1vv7Yb9h
8vOb3vImt/os951/PlXyr7bv30PGrZ3X9GTfj+/F+st9Vch54P04b5Z5F3lf
2p95VHu//nz/vFn/Aalqcz0=
    "], 
    {Hue[0.6, 0.3, 0.75], 
     LineBox[{{29, 30}, {30, 31}, {9, 29}, {29, 2}, {2, 3}, {3, 9}, {3, 10}, {
      10, 9}, {3, 4}, {4, 10}, {4, 11}, {11, 10}, {4, 5}, {5, 11}, {11, 33}, {
      33, 12}, {32, 33}, {33, 34}, {35, 32}, {32, 36}, {37, 36}, {36, 38}, {
      14, 37}, {37, 7}, {8, 9}, {9, 15}, {9, 16}, {16, 15}, {10, 16}, {10, 
      61}, {61, 16}, {11, 17}, {11, 62}, {62, 17}, {11, 40}, {40, 18}, {39, 
      40}, {40, 41}, {60, 41}, {41, 35}, {20, 60}, {60, 13}, {13, 43}, {43, 
      20}, {42, 43}, {43, 44}, {15, 46}, {46, 22}, {45, 46}, {46, 47}, {49, 
      47}, {47, 61}, {48, 49}, {49, 50}, {52, 50}, {50, 62}, {51, 52}, {52, 
      53}, {63, 53}, {53, 39}, {26, 63}, {63, 19}, {19, 55}, {55, 26}, {54, 
      55}, {55, 56}, {57, 56}, {56, 42}, {58, 57}, {57, 59}, {1, 31}, {29, 
      31}, {8, 30}, {5, 34}, {6, 32}, {32, 34}, {6, 36}, {13, 35}, {35, 36}, {
      12, 32}, {6, 38}, {37, 38}, {13, 36}, {12, 41}, {19, 39}, {39, 41}, {14,
       44}, {21, 42}, {42, 44}, {16, 47}, {23, 45}, {45, 47}, {17, 50}, {24, 
      48}, {48, 50}, {23, 49}, {18, 53}, {25, 51}, {51, 53}, {24, 52}, {20, 
      56}, {27, 54}, {54, 56}, {20, 42}, {21, 57}, {57, 42}, {27, 56}, {21, 
      59}, {28, 58}, {58, 59}, {27, 57}, {12, 35}, {60, 35}, {19, 41}, {17, 
      49}, {49, 61}, {23, 47}, {18, 52}, {52, 62}, {24, 50}, {18, 39}, {63, 
      39}, {25, 53}, {8, 29}, {5, 33}, {14, 13}, {13, 37}, {10, 17}, {17, 
      61}, {11, 18}, {18, 62}, {11, 12}, {12, 40}, {20, 19}, {19, 60}, {14, 
      43}, {16, 46}, {26, 25}, {25, 63}, {20, 55}}], {PointBox[{{1}}], 
      PointBox[{{2}}], PointBox[{{3}}], PointBox[{{4}}], PointBox[{{5}}], 
      PointBox[{{6}}], PointBox[{{7}}], PointBox[{{8}}], PointBox[{{9}}], 
      PointBox[{{10}}], PointBox[{{11}}], PointBox[{{12}}], PointBox[{{13}}], 
      PointBox[{{14}}], PointBox[{{15}}], PointBox[{{16}}], PointBox[{{17}}], 
      PointBox[{{18}}], PointBox[{{19}}], PointBox[{{20}}], PointBox[{{21}}], 
      PointBox[{{22}}], PointBox[{{23}}], PointBox[{{24}}], PointBox[{{25}}], 
      PointBox[{{26}}], PointBox[{{27}}], PointBox[{{28}}], PointBox[{{29}}], 
      PointBox[{{30}}], PointBox[{{31}}], PointBox[{{32}}], PointBox[{{33}}], 
      PointBox[{{34}}], PointBox[{{35}}], PointBox[{{36}}], PointBox[{{37}}], 
      PointBox[{{38}}], PointBox[{{39}}], PointBox[{{40}}], PointBox[{{41}}], 
      PointBox[{{42}}], PointBox[{{43}}], PointBox[{{44}}], PointBox[{{45}}], 
      PointBox[{{46}}], PointBox[{{47}}], PointBox[{{48}}], PointBox[{{49}}], 
      PointBox[{{50}}], PointBox[{{51}}], PointBox[{{52}}], PointBox[{{53}}], 
      PointBox[{{54}}], PointBox[{{55}}], PointBox[{{56}}], PointBox[{{57}}], 
      PointBox[{{58}}], PointBox[{{59}}], PointBox[{{60}}], PointBox[{{61}}], 
      PointBox[{{62}}], PointBox[{{63}}]}}]},
  ImageSize->{448.3333333333336, Automatic}]], "Output",
 CellChangeTimes->{
  3.668586734703586*^9, 3.668588320097186*^9, 3.668588896380887*^9, 
   3.6685891745539265`*^9, {3.6685892190158353`*^9, 3.6685892435487347`*^9}, {
   3.668589289975683*^9, 3.668589306503337*^9}, {3.6685894824637585`*^9, 
   3.668589538270357*^9}, 3.6685895864433756`*^9, 3.668589697093961*^9, 
   3.668600909003481*^9, 3.6686013458542585`*^9, 3.668601770927331*^9, 
   3.6686030951639156`*^9, 3.668603763781337*^9, 3.668604982314517*^9}]
}, Open  ]]
},
WindowSize->{795, 628},
WindowMargins->{{142, Automatic}, {Automatic, 17}},
Magnification:>1.25 Inherited,
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 486, 10, 90, "Input"],
Cell[1047, 32, 3330, 69, 221, "Input"],
Cell[4380, 103, 1226, 28, 106, "Input"],
Cell[CellGroupData[{
Cell[5631, 135, 1276, 22, 83, "Input"],
Cell[6910, 159, 3642, 69, 254, "Output"],
Cell[10555, 230, 4758, 70, 255, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
