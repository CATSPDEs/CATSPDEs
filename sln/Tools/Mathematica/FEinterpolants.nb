(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     64930,       1671]
NotebookOptionsPosition[     63059,       1607]
NotebookOutlinePosition[     63405,       1622]
CellTagsIndexPosition[     63362,       1619]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Routines for Computing Shape Funcs of Different FEs and Post\[Dash]processing\
\>", "Title",
 CellChangeTimes->{{3.6859678194907494`*^9, 3.6859678771496162`*^9}}],

Cell["Some explanation goes here...", "Text",
 CellChangeTimes->{{3.685967891721883*^9, 3.6859679049366827`*^9}}],

Cell[CellGroupData[{

Cell["Finite Elements", "Section",
 CellChangeTimes->{{3.6859680655374765`*^9, 3.6859680715170174`*^9}}],

Cell["Here we should clarify our notations...", "Text",
 CellChangeTimes->{{3.6859680972650356`*^9, 3.6859681088535423`*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "\[CapitalDelta] ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["P", "0"], TraditionalForm]]],
 " Lagrange"
}], "Subsection",
 CellChangeTimes->{{3.685968124697133*^9, 3.685968168637723*^9}, {
  3.685969897758335*^9, 3.685969900053405*^9}, {3.6859710110485563`*^9, 
  3.6859710128808317`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalDelta]P0L", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<name\>\"", "\[Rule]", 
      "\"\<\[CapitalDelta] \!\(\*SuperscriptBox[\(P\), \(0\)]\) L\>\""}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"\"\<shape funcs\>\"", "\[Rule]", " ", 
      RowBox[{"{", "1", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "get", " ", "numeration", " ", "of", " ", "shape", " ", "funcs", " ", 
       "of", " ", 
       SuperscriptBox["t", "th"], " ", "triangle", " ", "of", " ", 
       "\[ScriptCapitalT]"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\"\<DOFs numn\>\"", "\[Rule]", " ", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[ScriptCapitalT]", ",", "t"}], "}"}], ",", 
        RowBox[{"{", "t", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<numb of DOFs\>\"", "\[Rule]", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "\[ScriptCapitalT]", "}"}], ",", 
        RowBox[{"numbOf\[CapitalDelta]", "@", "\[ScriptCapitalT]"}]}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<DOFs nodes\>\"", "\[Rule]", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[ScriptCapitalT]", ",", "t"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"centroid", "[", 
          RowBox[{"\[ScriptCapitalT]", ",", "t"}], "]"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "|>"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.685968216783662*^9, 3.685968229541868*^9}, {
   3.685968337920841*^9, 3.6859683548472805`*^9}, {3.6859687039279757`*^9, 
   3.685968709615796*^9}, {3.6859688902303314`*^9, 3.685968928086708*^9}, {
   3.685968988767154*^9, 3.6859689906448164`*^9}, {3.6859690557508965`*^9, 
   3.68596908085422*^9}, {3.6859691521542616`*^9, 3.685969156509284*^9}, {
   3.6859692106749916`*^9, 3.68596922398118*^9}, {3.685969326546307*^9, 
   3.685969402727768*^9}, {3.6859694361460743`*^9, 3.685969455330901*^9}, {
   3.6859699812283545`*^9, 3.685970035157882*^9}, 3.6859700668720455`*^9, {
   3.6859707995241547`*^9, 3.685970800324766*^9}, {3.686026170751086*^9, 
   3.6860262546038847`*^9}, {3.686033032112721*^9, 3.6860330332784595`*^9}, {
   3.6868500972763453`*^9, 3.686850142828947*^9}, {3.6868501967863073`*^9, 
   3.686850204409054*^9}, {3.6868502585408907`*^9, 3.6868502960861177`*^9}, {
   3.6945282212508793`*^9, 3.694528224103549*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "\[CapitalDelta] ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["P", "1"], TraditionalForm]]],
 " Lagrange"
}], "Subsection",
 CellChangeTimes->{{3.685968124697133*^9, 3.685968168637723*^9}, {
  3.685969897758335*^9, 3.685969900053405*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"Inverse", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["x", "1"], ",", 
        SubscriptBox["x", "2"], ",", 
        SubscriptBox["x", "3"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["y", "1"], ",", 
        SubscriptBox["y", "2"], ",", 
        SubscriptBox["y", "3"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S1", "[", 
    RowBox[{"u_", ",", "v_"}], "]"}], "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"A", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ".", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S2", "[", 
    RowBox[{"u_", ",", "v_"}], "]"}], "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"A", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ".", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S3", "[", 
    RowBox[{"u_", ",", "v_"}], "]"}], "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"A", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ".", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]P1L", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<name\>\"", "\[Rule]", 
      "\"\<\[CapitalDelta] \!\(\*SuperscriptBox[\(P\), \(1\)]\) L\>\""}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"\"\<shape funcs\>\"", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"S1", "[", 
         RowBox[{"x", ",", "y"}], "]"}], ",", 
        RowBox[{"S2", "[", 
         RowBox[{"x", ",", "y"}], "]"}], ",", 
        RowBox[{"S3", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "get", " ", "numeration", " ", "of", " ", "shape", " ", "funcs", " ", 
       "of", " ", 
       SuperscriptBox["t", "th"], " ", "triangle", " ", "of", " ", 
       "\[ScriptCapitalT]"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\"\<DOFs numn\>\"", "\[Rule]", " ", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[ScriptCapitalT]", ",", "t"}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"\[ScriptCapitalT]", "[", "\"\<triangles\>\"", "]"}], "[", 
          RowBox[{"[", "t", "]"}], "]"}], "+", "1"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<numb of DOFs\>\"", "\[Rule]", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "\[ScriptCapitalT]", "}"}], ",", 
        RowBox[{"numbOf\[ScriptN]", "@", "\[ScriptCapitalT]"}]}], "]"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<DOFs nodes\>\"", "\[Rule]", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[ScriptCapitalT]", ",", "t"}], "}"}], ",", 
        RowBox[{"\[ScriptN]", "[", 
         RowBox[{"\[ScriptCapitalT]", ",", "t"}], "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "|>"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.685968216783662*^9, 3.685968229541868*^9}, {
   3.685968337920841*^9, 3.6859683548472805`*^9}, {3.6859687039279757`*^9, 
   3.685968709615796*^9}, {3.6859688902303314`*^9, 3.685968928086708*^9}, {
   3.685968988767154*^9, 3.6859689906448164`*^9}, {3.6859690557508965`*^9, 
   3.68596908085422*^9}, {3.6859691521542616`*^9, 3.685969156509284*^9}, {
   3.6859692106749916`*^9, 3.68596922398118*^9}, {3.685969326546307*^9, 
   3.685969402727768*^9}, {3.6859694361460743`*^9, 3.685969455330901*^9}, {
   3.6859699812283545`*^9, 3.685970035157882*^9}, 3.6859700668720455`*^9, {
   3.6859707995241547`*^9, 3.685970800324766*^9}, {3.6860255920258956`*^9, 
   3.6860256168797207`*^9}, {3.6868505128721027`*^9, 
   3.6868505264140368`*^9}, {3.6868505863059974`*^9, 3.686850589178393*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "\[CapitalDelta] ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["P", "2"], TraditionalForm]]],
 " Lagrange"
}], "Subsection",
 CellChangeTimes->{{3.685968124697133*^9, 3.685968168637723*^9}, {
  3.685969897758335*^9, 3.685969900053405*^9}, {3.689215372110083*^9, 
  3.6892153723009124`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"Inverse", "@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["x", "1"], "2"], ",", 
        SuperscriptBox[
         SubscriptBox["x", "2"], "2"], ",", 
        SuperscriptBox[
         SubscriptBox["x", "3"], "2"], ",", 
        SuperscriptBox[
         SubscriptBox["x", "4"], "2"], ",", 
        SuperscriptBox[
         SubscriptBox["x", "5"], "2"], ",", 
        SuperscriptBox[
         SubscriptBox["x", "6"], "2"]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["y", "1"], "2"], ",", 
        SuperscriptBox[
         SubscriptBox["y", "2"], "2"], ",", 
        SuperscriptBox[
         SubscriptBox["y", "3"], "2"], ",", 
        SuperscriptBox[
         SubscriptBox["y", "4"], "2"], ",", 
        SuperscriptBox[
         SubscriptBox["y", "5"], "2"], ",", 
        SuperscriptBox[
         SubscriptBox["y", "6"], "2"]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["x", "1"], 
         SubscriptBox["y", "1"]}], ",", 
        RowBox[{
         SubscriptBox["x", "2"], 
         SubscriptBox["y", "2"]}], ",", 
        RowBox[{
         SubscriptBox["x", "3"], 
         SubscriptBox["y", "3"]}], ",", 
        RowBox[{
         SubscriptBox["x", "4"], 
         SubscriptBox["y", "4"]}], ",", 
        RowBox[{
         SubscriptBox["x", "5"], 
         SubscriptBox["y", "5"]}], ",", 
        RowBox[{
         SubscriptBox["x", "6"], 
         SubscriptBox["y", "6"]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["x", "1"], ",", 
        SubscriptBox["x", "2"], ",", 
        SubscriptBox["x", "3"], ",", 
        SubscriptBox["x", "4"], ",", 
        SubscriptBox["x", "5"], ",", 
        SubscriptBox["x", "6"]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["y", "1"], ",", 
        SubscriptBox["y", "2"], ",", 
        SubscriptBox["y", "3"], ",", 
        SubscriptBox["y", "4"], ",", 
        SubscriptBox["y", "5"], ",", 
        SubscriptBox["y", "6"]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
       "}"}]}], "\[IndentingNewLine]", "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"u_", ",", "v_", ",", "i_Integer"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"A", "[", 
     RowBox[{"[", "i", "]"}], "]"}], ".", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["u", "2"], ",", 
      SuperscriptBox["v", "2"], ",", 
      RowBox[{"u", " ", "v"}], ",", "u", ",", "v", ",", "1"}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.685968216783662*^9, 3.685968229541868*^9}, {
   3.685968337920841*^9, 3.6859683548472805`*^9}, {3.6859687039279757`*^9, 
   3.685968709615796*^9}, {3.6859688902303314`*^9, 3.685968928086708*^9}, {
   3.685968988767154*^9, 3.6859689906448164`*^9}, {3.6859690557508965`*^9, 
   3.68596908085422*^9}, {3.6859691521542616`*^9, 3.685969156509284*^9}, {
   3.6859692106749916`*^9, 3.68596922398118*^9}, {3.685969326546307*^9, 
   3.685969402727768*^9}, {3.6859694361460743`*^9, 3.685969455330901*^9}, {
   3.6859699812283545`*^9, 3.685970035157882*^9}, 3.6859700668720455`*^9, {
   3.6859707995241547`*^9, 3.685970800324766*^9}, {3.6860255920258956`*^9, 
   3.6860256168797207`*^9}, {3.6868505128721027`*^9, 
   3.6868505264140368`*^9}, {3.6868505863059974`*^9, 3.686850589178393*^9}, {
   3.689215436262046*^9, 3.6892154476845303`*^9}, {3.689215488154736*^9, 
   3.6892155869537835`*^9}, {3.689215629856391*^9, 3.689215729465658*^9}, {
   3.689215835688383*^9, 3.6892158552095814`*^9}, {3.689215942714385*^9, 
   3.689215977922194*^9}, {3.6892160153362045`*^9, 3.689216064118354*^9}, {
   3.6892161050550423`*^9, 3.689216138454954*^9}, {3.68921635872421*^9, 
   3.6892163588975396`*^9}, {3.68921655789689*^9, 3.689216576352193*^9}, {
   3.6892168071382513`*^9, 3.6892168076507425`*^9}, {3.6892178532677526`*^9, 
   3.689217856082945*^9}, {3.6892237729166374`*^9, 3.689223775303681*^9}, 
   3.689223812784223*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalDelta]P2L", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<name\>\"", "\[Rule]", 
      "\"\<\[CapitalDelta] \!\(\*SuperscriptBox[\(P\), \(2\)]\) L\>\""}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\"\<shape funcs\>\"", "\[Rule]", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{"x", ",", "y", ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "6"}], "}"}]}], "]"}]}], "/.", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          SubscriptBox["x", "4"], "\[Rule]", 
          FractionBox[
           RowBox[{
            SubscriptBox["x", "2"], "+", 
            SubscriptBox["x", "3"]}], "2"]}], ",", 
         RowBox[{
          SubscriptBox["y", "4"], "\[Rule]", 
          FractionBox[
           RowBox[{
            SubscriptBox["y", "2"], "+", 
            SubscriptBox["y", "3"]}], "2"]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["x", "5"], "\[Rule]", 
          FractionBox[
           RowBox[{
            SubscriptBox["x", "1"], "+", 
            SubscriptBox["x", "3"]}], "2"]}], ",", 
         RowBox[{
          SubscriptBox["y", "5"], "\[Rule]", 
          FractionBox[
           RowBox[{
            SubscriptBox["y", "1"], "+", 
            SubscriptBox["y", "3"]}], "2"]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["x", "6"], "\[Rule]", 
          FractionBox[
           RowBox[{
            SubscriptBox["x", "1"], "+", 
            SubscriptBox["x", "2"]}], "2"]}], ",", 
         RowBox[{
          SubscriptBox["y", "6"], "\[Rule]", 
          FractionBox[
           RowBox[{
            SubscriptBox["y", "1"], "+", 
            SubscriptBox["y", "2"]}], "2"]}]}], "\[IndentingNewLine]", 
        "}"}]}], "//", "FullSimplify"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "get", " ", "numeration", " ", "of", " ", "shape", " ", "funcs", " ", 
       "of", " ", 
       SuperscriptBox["t", "th"], " ", "triangle", " ", "of", " ", 
       "\[ScriptCapitalT]"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\"\<DOFs numn\>\"", "\[Rule]", " ", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[ScriptCapitalT]", ",", "t"}], "}"}], ",", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[ScriptCapitalT]", "[", "\"\<triangles\>\"", "]"}], "[", 
            RowBox[{"[", "t", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"\[ScriptCapitalT]", "[", "\"\<ribs\>\"", "]"}], "[", 
             RowBox[{"[", "t", "]"}], "]"}], "+", 
            RowBox[{"numbOf\[ScriptN]", "@", "\[ScriptCapitalT]"}]}]}], "]"}],
          "+", "1"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<numb of DOFs\>\"", "\[Rule]", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "\[ScriptCapitalT]", "}"}], ",", 
        RowBox[{
         RowBox[{"numbOf\[ScriptN]", "@", "\[ScriptCapitalT]"}], "+", 
         RowBox[{"numbOf\[ScriptR]", "@", "\[ScriptCapitalT]"}]}]}], "]"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<DOFs nodes\>\"", "\[Rule]", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[ScriptCapitalT]", ",", "t"}], "}"}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"\[ScriptN]", "[", 
           RowBox[{"\[ScriptCapitalT]", ",", "t"}], "]"}], ",", 
          RowBox[{"\[ScriptM]", "[", 
           RowBox[{"\[ScriptCapitalT]", ",", "t"}], "]"}]}], "]"}]}], 
       "]"}]}]}], "\[IndentingNewLine]", "|>"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.68921786024095*^9, 3.6892178622906494`*^9}, {
  3.6892237158300705`*^9, 3.689223768649334*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "\[CapitalDelta] ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["P", "1"], TraditionalForm]]],
 " Crouzeix",
 "\[Dash]Raviart"
}], "Subsection",
 CellChangeTimes->{{3.685968124697133*^9, 3.685968168637723*^9}, {
  3.685969897758335*^9, 3.6859699266591034`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalDelta]P1CR", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<name\>\"", "\[Rule]", 
      "\"\<\[CapitalDelta] \!\(\*SuperscriptBox[\(P\), \(1\)]\) CR\>\""}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "change", " ", "Lagrange", " ", "vertices", " ", "to", " ", "mid", " ", 
       "nodes"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\"\<shape funcs\>\"", "\[Rule]", " ", 
        RowBox[{"\[CapitalDelta]P1L", "[", "\"\<shape funcs\>\"", "]"}]}], "/.", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          SubscriptBox["x", "1"], "\[Rule]", 
          FractionBox[
           RowBox[{
            SubscriptBox["x", "2"], "+", 
            SubscriptBox["x", "3"]}], "2"]}], ",", 
         RowBox[{
          SubscriptBox["y", "1"], "\[Rule]", 
          FractionBox[
           RowBox[{
            SubscriptBox["y", "2"], "+", 
            SubscriptBox["y", "3"]}], "2"]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["x", "2"], "\[Rule]", 
          FractionBox[
           RowBox[{
            SubscriptBox["x", "1"], "+", 
            SubscriptBox["x", "3"]}], "2"]}], ",", 
         RowBox[{
          SubscriptBox["y", "2"], "\[Rule]", 
          FractionBox[
           RowBox[{
            SubscriptBox["y", "1"], "+", 
            SubscriptBox["y", "3"]}], "2"]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["x", "3"], "\[Rule]", 
          FractionBox[
           RowBox[{
            SubscriptBox["x", "1"], "+", 
            SubscriptBox["x", "2"]}], "2"]}], ",", 
         RowBox[{
          SubscriptBox["y", "3"], "\[Rule]", 
          FractionBox[
           RowBox[{
            SubscriptBox["y", "1"], "+", 
            SubscriptBox["y", "2"]}], "2"]}]}], "\[IndentingNewLine]", 
        "}"}]}], "//", "FullSimplify"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "get", " ", "numeration", " ", "of", " ", "shape", " ", "funcs", " ", 
       "of", " ", 
       SuperscriptBox["t", "th"], " ", "triangle", " ", "of", " ", 
       "\[ScriptCapitalT]"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\"\<DOFs numn\>\"", "\[Rule]", " ", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[ScriptCapitalT]", ",", "t"}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"\[ScriptCapitalT]", "[", "\"\<ribs\>\"", "]"}], "[", 
          RowBox[{"[", "t", "]"}], "]"}], "+", "1"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<numb of DOFs\>\"", "\[Rule]", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "\[ScriptCapitalT]", "}"}], ",", 
        RowBox[{"numbOf\[ScriptR]", "@", "\[ScriptCapitalT]"}]}], "]"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<DOFs nodes\>\"", "\[Rule]", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[ScriptCapitalT]", ",", "t"}], "}"}], ",", 
        RowBox[{"\[ScriptM]", "[", 
         RowBox[{"\[ScriptCapitalT]", ",", "t"}], "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "|>"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.685970048451213*^9, 3.6859700879237604`*^9}, {
  3.685970141850233*^9, 3.6859702034856386`*^9}, {3.685970267618846*^9, 
  3.6859704400595803`*^9}, {3.685970497532671*^9, 3.6859704982339993`*^9}, {
  3.685970620063551*^9, 3.6859706717552657`*^9}, {3.6859707245604267`*^9, 
  3.6859707911661935`*^9}, {3.686026116069451*^9, 3.686026119822516*^9}, {
  3.6868506158819904`*^9, 3.6868506479781537`*^9}, {3.686850693589802*^9, 
  3.6868506963621173`*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Routines", "Section",
 CellChangeTimes->{{3.686026356025319*^9, 3.686026362039364*^9}, {
  3.6860347492981224`*^9, 3.6860347521660557`*^9}}],

Cell[CellGroupData[{

Cell["Shape Funcs", "Subsection",
 CellChangeTimes->{{3.686034655604019*^9, 3.6860346709792185`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"compute", " ", "shape", " ", "funcs", " ", 
    RowBox[{"(", 
     RowBox[{"subst", " ", "vertices"}], ")"}], " ", "of", " ", "given", " ", 
    "FE", " ", "at", " ", 
    SuperscriptBox["t", "th"], " ", "triangle", " ", "of", " ", "mesh", " ", 
    "\[ScriptCapitalT]"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"shapes", "[", 
     RowBox[{"FE_", ",", "\[ScriptCapitalT]_", ",", "t_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"FE", "[", "\"\<shape funcs\>\"", "]"}], "/.", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SubscriptBox["x", "i"], "\[Rule]", 
           RowBox[{
            RowBox[{"\[ScriptN]", "[", 
             RowBox[{"\[ScriptCapitalT]", ",", "t"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
          RowBox[{
           SubscriptBox["y", "i"], "\[Rule]", 
           RowBox[{
            RowBox[{"\[ScriptN]", "[", 
             RowBox[{"\[ScriptCapitalT]", ",", "t"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"plot", " ", "\[DoublePrime]"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotShapes", "[", 
     RowBox[{"FE_", ",", "\[ScriptCapitalT]_", ",", "t_"}], "]"}], ":=", 
    RowBox[{"Plot3D", "[", 
     RowBox[{
      RowBox[{"Evaluate", "@", 
       RowBox[{"shapes", "[", 
        RowBox[{"FE", ",", "\[ScriptCapitalT]", ",", "t"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], "\[Element]", 
       RowBox[{"\[CapitalDelta]", "[", 
        RowBox[{"\[ScriptCapitalT]", ",", "t"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], "}"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"PlotLegends", "\[Rule]", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"\"\<S\>\"", ",", 
           RowBox[{"ToString", "@", "i"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", 
            RowBox[{"shapes", "[", 
             RowBox[{"FE", ",", "\[ScriptCapitalT]", ",", "t"}], "]"}]}]}], 
          "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"\"\<Shape Funcs of \>\"", "<>", 
          RowBox[{"FE", "[", "\"\<name\>\"", "]"}], "<>", 
          "\"\< Finite Element\>\""}]}], ","}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Mesh", "\[Rule]", "None"}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6859695281482215`*^9, 3.685969689280716*^9}, {
   3.685969787040172*^9, 3.6859698507668715`*^9}, {3.686025388730815*^9, 
   3.6860254660699997`*^9}, {3.6860255393689375`*^9, 
   3.6860255600248404`*^9}, {3.6860256380253716`*^9, 3.68602564706378*^9}, {
   3.6860256920966387`*^9, 3.686025706924755*^9}, {3.686025742646099*^9, 
   3.6860258313308177`*^9}, {3.686025871675254*^9, 3.6860259089560685`*^9}, {
   3.686025991803807*^9, 3.6860260394565916`*^9}, {3.6860264267092333`*^9, 
   3.686026470528058*^9}, {3.686026502083705*^9, 3.68602655539047*^9}, {
   3.686026587547728*^9, 3.686026619014985*^9}, {3.686026668927056*^9, 
   3.6860267987377834`*^9}, {3.6860268846432743`*^9, 3.686026889240469*^9}, {
   3.686027294620928*^9, 3.6860273835013213`*^9}, {3.6860274221534433`*^9, 
   3.6860274715001664`*^9}, {3.6860275527663374`*^9, 3.686027647417424*^9}, {
   3.6860279742576656`*^9, 3.68602797559449*^9}, {3.686028112405337*^9, 
   3.686028161200621*^9}, {3.686028304272778*^9, 3.6860283070958443`*^9}, {
   3.6860283838714914`*^9, 3.686028462730625*^9}, {3.6860285720103455`*^9, 
   3.6860286059820843`*^9}, {3.686028731928196*^9, 3.6860289332262225`*^9}, 
   3.6860289964542427`*^9, {3.686029044932108*^9, 3.686029051132351*^9}, {
   3.6860290879400783`*^9, 3.6860290934351006`*^9}, {3.6860291655891657`*^9, 
   3.6860291663528786`*^9}, {3.6860293556031084`*^9, 
   3.6860293963323092`*^9}, {3.6860294388232727`*^9, 
   3.6860294524560895`*^9}, {3.686029700648018*^9, 3.686029705318122*^9}, {
   3.6860297747134995`*^9, 3.6860297753930197`*^9}, {3.686029984732606*^9, 
   3.686029996075167*^9}, {3.686030028952855*^9, 3.686030033345684*^9}, {
   3.686030113472826*^9, 3.6860301136636257`*^9}, {3.6860302578642983`*^9, 
   3.6860302672410684`*^9}, {3.68603095968018*^9, 3.686031002718219*^9}, {
   3.6860310999410257`*^9, 3.686031108672538*^9}, {3.686031153642042*^9, 
   3.6860311543366013`*^9}, {3.686032363534231*^9, 3.686032378033685*^9}, {
   3.6860325504631557`*^9, 3.686032560681758*^9}, {3.6860326295671587`*^9, 
   3.6860326301481447`*^9}, 3.6860326717509117`*^9, {3.686032723052828*^9, 
   3.686032746018878*^9}, {3.6860328044391994`*^9, 3.6860328136610413`*^9}, {
   3.68603286864145*^9, 3.6860328780693398`*^9}, {3.6860330454055324`*^9, 
   3.6860330455839467`*^9}, {3.6860331124419584`*^9, 
   3.6860331149591007`*^9}, {3.686033174926671*^9, 3.6860333256035223`*^9}, {
   3.686033381380982*^9, 3.6860333953933077`*^9}, {3.686033443657297*^9, 
   3.686033492601857*^9}, {3.686033529946352*^9, 3.686033532223304*^9}, {
   3.6860336241797667`*^9, 3.6860336565736403`*^9}, {3.686033702591258*^9, 
   3.6860337055755906`*^9}, {3.6860337578499756`*^9, 3.686033802887066*^9}, {
   3.6860338332413073`*^9, 3.6860338368452053`*^9}, {3.686033947221618*^9, 
   3.6860339479281015`*^9}, {3.6860339954012833`*^9, 3.686034023686001*^9}, {
   3.686034208691261*^9, 3.686034229214196*^9}, {3.686034440122143*^9, 
   3.6860344422249303`*^9}, {3.6860346811179724`*^9, 3.686034681578143*^9}, {
   3.690794587074549*^9, 3.6907945874417925`*^9}, {3.6908008193772955`*^9, 
   3.690800819681093*^9}, {3.697629738371993*^9, 3.697629742589909*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"toCPP", "[", "f_", "]"}], ":=", 
  RowBox[{"InputForm", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"N", "@", "f"}], "/.", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SubscriptBox["x", "i"], "\[Rule]", 
           RowBox[{
            RowBox[{"t", "[", 
             RowBox[{"i", "-", "1"}], "]"}], "[", "0", "]"}]}], ",", 
          RowBox[{
           SubscriptBox["y", "i"], "\[Rule]", 
           RowBox[{
            RowBox[{"t", "[", 
             RowBox[{"i", "-", "1"}], "]"}], "[", "1", "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "\[Rule]", 
       RowBox[{"p", "[", "0", "]"}]}], ",", 
      RowBox[{"y", "\[Rule]", 
       RowBox[{"p", "[", "1", "]"}]}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.691073093692113*^9, 3.6910731552444086`*^9}, {
  3.6910732013825417`*^9, 3.6910732842011814`*^9}, {3.691073595179359*^9, 
  3.6910736538077583`*^9}, {3.6910741222526827`*^9, 3.6910741737950535`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Basis Funcs", "Subsection",
 CellChangeTimes->{{3.6860346934501915`*^9, 3.6860346969382915`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"plot", " ", 
    SuperscriptBox["i", "th"], " ", "basis", " ", "func"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"plotBasis", "[", 
    RowBox[{"FE_", ",", "\[ScriptCapitalT]_", ",", "i_", ",", 
     RowBox[{"style_:", 
      RowBox[{"{", "}"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"plots", "=", 
        RowBox[{"{", "}"}]}], ",", "f", ",", "pos"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"pos", "=", 
          RowBox[{
           RowBox[{"FirstPosition", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"FE", "[", "\"\<DOFs numn\>\"", "]"}], "[", 
              RowBox[{"\[ScriptCapitalT]", ",", "t"}], "]"}], ",", "i", ",", 
             RowBox[{"{", "0", "}"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"pos", "\[NotEqual]", "0"}], ",", 
           RowBox[{"f", "=", 
            RowBox[{
             RowBox[{"shapes", "[", 
              RowBox[{"FE", ",", "\[ScriptCapitalT]", ",", "t"}], "]"}], "[", 
             RowBox[{"[", "pos", "]"}], "]"}]}], ",", 
           RowBox[{"f", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"plots", ",", 
           RowBox[{"Plot3D", "[", 
            RowBox[{"f", ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "\[Element]", 
              RowBox[{"\[CapitalDelta]", "[", 
               RowBox[{"\[ScriptCapitalT]", ",", "t"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Mesh", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotStyle", "\[Rule]", "style"}]}], 
            "\[IndentingNewLine]", "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{"numbOf\[CapitalDelta]", "@", "\[ScriptCapitalT]"}]}], 
         "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{"plots", ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"BoxRatios", "\[Rule]", "Automatic"}], ","}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
          "}"}]}]}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"\"\<Basis Function \:2116\>\"", "<>", 
          RowBox[{"ToString", "@", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}], "<>", "\"\< of \>\"", "<>", 
          RowBox[{"FE", "[", "\"\<name\>\"", "]"}], "<>", 
          "\"\< FE\[Dash]interpolant\>\""}]}], "*)"}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQnfM4d35v2WvHaxf6wXTYjTs/ZwDpc5cZ/oLofXn/
GWcCaesMCxYQPaF5HQtP5WvHdG92ThAdUm9z404tUP+WBTdB9LsLJ5+AaKcy
2fcgekmsNtNdIO2nYg2mm2Kk5ED0qbI6eRC98PxUdRC9x/EcmO5rq9UF0VuZ
J4Lpf5LNriB64t8XYNppgnz/wvrXjgXXpeaAaBvfnUtB9M2dbKtANFPi37Ug
+oPD9S0gepdK5k4QbTH95D4Q/XyJ9BEQveOYJZgOOiK8d3XPa8dla5/tB9Ev
7u5lWwOkZ6R9ANMeGhe4QDSPrxc3iAYAoJunOw==
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell["FE\[Dash]Interpolant", "Subsection",
 CellChangeTimes->{{3.6860348452417607`*^9, 3.6860348553487105`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"compute", " ", "vector", " ", "of", " ", "DOFs", " ", "\[Xi]"}],
      " ", "="}], " ", "\[InvisibleComma]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{
        RowBox[{"f", 
         RowBox[{"(", 
          SubscriptBox["x", "1"], ")"}]}], ",", " ", 
        RowBox[{"f", 
         RowBox[{"(", 
          SubscriptBox["x", "2"], ")"}]}], ",", " ", "\[Ellipsis]", ",", " ", 
        RowBox[{"f", 
         RowBox[{"(", 
          SubscriptBox["x", "n"], ")"}]}]}], "\[RightAngleBracket]"}], " ", 
      "for", " ", "FE"}], "\[Dash]", 
     RowBox[{"interpolant", " ", "\[ScriptCapitalP]\[Xi]"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"computeDOFs", "[", 
    RowBox[{"f_", ",", "FE_", ",", "\[ScriptCapitalT]_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Xi]", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"FE", "[", "\"\<numb of DOFs\>\"", "]"}], "@", 
            "\[ScriptCapitalT]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Xi]", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"FE", "[", "\"\<DOFs numn\>\"", "]"}], "[", 
            RowBox[{"\[ScriptCapitalT]", ",", "t"}], "]"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"f", "@@", "#"}], "&"}], "/@", 
          RowBox[{
           RowBox[{"FE", "[", "\"\<DOFs nodes\>\"", "]"}], "[", 
           RowBox[{"\[ScriptCapitalT]", ",", "t"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{"numbOf\[CapitalDelta]", "@", "\[ScriptCapitalT]"}]}], 
         "}"}]}], "]"}], ";", "\[IndentingNewLine]", "\[Xi]"}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6868494045176888`*^9, 3.6868494636995754`*^9}, {
  3.686849498297863*^9, 3.686849526127041*^9}, {3.686849836655379*^9, 
  3.686849972603608*^9}, {3.686850044380248*^9, 3.6868500661658325`*^9}, {
  3.6868501539937353`*^9, 3.6868501668706374`*^9}, {3.6868503079474306`*^9, 
  3.686850501518335*^9}, {3.686852179929042*^9, 3.6868522137567472`*^9}, {
  3.694189633388112*^9, 3.694189644060297*^9}, {3.6941897331180663`*^9, 
  3.6941897480577526`*^9}, {3.6945280346235623`*^9, 3.6945280436971617`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"\[ScriptCapitalP]", " ", ":", " ", 
     SubscriptBox["\[DoubleStruckCapitalR]", "H"]}], " ", "\[Rule]", " ", 
    SubscriptBox["\[DoubleStruckCapitalU]", "H"]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\[ScriptCapitalP]", "[", 
    RowBox[{"\[Xi]_", ",", "FE_", ",", "\[ScriptCapitalT]_"}], "]"}], ":=", 
   RowBox[{"FullSimplify", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Xi]", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"FE", "[", "\"\<DOFs numn\>\"", "]"}], "[", 
          RowBox[{"\[ScriptCapitalT]", ",", "t"}], "]"}], "]"}], "]"}], ".", 
       RowBox[{"shapes", "[", 
        RowBox[{"FE", ",", "\[ScriptCapitalT]", ",", "t"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", 
        RowBox[{"numbOf\[CapitalDelta]", "@", "\[ScriptCapitalT]"}]}], 
       "}"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6860368758287544`*^9, 3.6860368844583583`*^9}, {
   3.6860369201670647`*^9, 3.686036963855311*^9}, {3.6860369963302355`*^9, 
   3.6860370900465527`*^9}, 3.686037120850155*^9, 3.6860377302007957`*^9, {
   3.68603833767213*^9, 3.686038358205168*^9}, {3.6860611707734947`*^9, 
   3.6860611757151732`*^9}, {3.686849632880842*^9, 3.686849706899338*^9}, {
   3.686849740596737*^9, 3.686849751889888*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"imageOf", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1_", ",", "x2_"}], "}"}], ",", "\[ScriptCapitalP]\[Xi]_", ",", 
    "\[ScriptCapitalT]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t", "=", "1"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x1", ",", "x2"}], "}"}], "\[NotElement]", 
         RowBox[{"\[CapitalDelta]", "[", 
          RowBox[{"\[ScriptCapitalT]", ",", "t"}], "]"}]}], "&&", 
        RowBox[{"t", "\[LessEqual]", 
         RowBox[{"numbOf\[CapitalDelta]", "@", "\[ScriptCapitalT]"}]}]}], ",", 
       RowBox[{"t", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"t", "\[LessEqual]", 
        RowBox[{"numbOf\[CapitalDelta]", "@", "\[ScriptCapitalT]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[ScriptCapitalP]\[Xi]", "[", 
         RowBox[{"[", "t", "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", "x1"}], ",", 
          RowBox[{"y", "\[Rule]", "x2"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", "\"\<not defined\>\""}]}], "\[IndentingNewLine]",
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6986688449802527`*^9, 3.698668908418201*^9}, {
   3.698669016680667*^9, 3.698669021631656*^9}, {3.6986690583944244`*^9, 
   3.69866938860919*^9}, {3.6986695375035686`*^9, 3.698669544065499*^9}, 
   3.6986695910092945`*^9, 3.6986699171538687`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"interpolant", " ", "on", " ", "structured", " ", "grid"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"buildStructuredInterpolant", "[", 
    RowBox[{"\[ScriptCapitalP]\[Xi]_", ",", "\[ScriptCapitalT]_", ",", 
     RowBox[{"{", 
      RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2_", ",", "y2_"}], "}"}], ",", "hx_", ",", "hy_", ",", 
     "start_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"res", ",", "neighbors", ",", 
       RowBox[{"t", "=", "start"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "0."}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", "y1", ",", "y2", ",", "hy"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "x1", ",", "x2", ",", "hx"}], "}"}]}], "]"}], 
         ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"t", "\[NotEqual]", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{"check", " ", "neighbors", " ", "first"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "@", "\"\<neigbors\>\""}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"neighbors", "=", 
             RowBox[{"Prepend", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"\[ScriptCapitalT]", "[", "\"\<neighbors\>\"", "]"}],
                  "[", 
                 RowBox[{"[", "t", "]"}], "]"}], "+", "1"}], ",", "t"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"t", "=", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"n", "\[NotEqual]", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"res", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", 
                    RowBox[{";;", "2"}]}], "]"}], "]"}], "\[Element]", 
                  RowBox[{"\[CapitalDelta]", "[", 
                   RowBox[{"\[ScriptCapitalT]", ",", "n"}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"res", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{"\[ScriptCapitalP]\[Xi]", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "/.", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "\[Rule]", 
                    RowBox[{"res", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
                    RowBox[{"y", "\[Rule]", 
                    RowBox[{"res", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}]}]}], ";",
                  "\[IndentingNewLine]", 
                 RowBox[{"t", "=", "n"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", "neighbors"}], "}"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"t", "\[Equal]", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{"brute", " ", "force"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "@", "\"\<brute\>\""}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"t", "=", "1"}], ";", "\[IndentingNewLine]", 
            RowBox[{"While", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"res", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{";;", "2"}]}], "]"}], "]"}], "\[NotElement]", 
                RowBox[{"\[CapitalDelta]", "[", 
                 RowBox[{"\[ScriptCapitalT]", ",", "t"}], "]"}]}], "&&", 
               RowBox[{"t", "\[LessEqual]", 
                RowBox[{
                "numbOf\[CapitalDelta]", "@", "\[ScriptCapitalT]"}]}]}], ",", 
              RowBox[{"t", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"res", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "3"}], "]"}], "]"}], "=", 
             RowBox[{
              RowBox[{"\[ScriptCapitalP]\[Xi]", "[", 
               RowBox[{"[", "t", "]"}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"x", "\[Rule]", 
                 RowBox[{"res", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
                RowBox[{"y", "\[Rule]", 
                 RowBox[{"res", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}]}]}]}]}], 
          "\[IndentingNewLine]", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "res"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzFsoQwEABuBhDyvqNOnE05wYNh0PyMOQHZc1bCuSl206RBQy0lp5kOZB
uYXJZfFgijO8SCnj0SXm3rIl0TS55RLjZS77z8Pf9/L/P1XXVtkQKRAIEsOB
7Yrbs8WhJ6bX0nYLP79kj7DKTj1BtzvmFapis6O5sJNNvyQ8FqXHQ88URUOF
nciA7qguJZQ3FTCweHO0BB6+SDXQofbooc4tqYHaO5kVtpAVY9DykDIBN/5Y
B2S9+xwMJglX4YOXPIACQ/0FNP0ERM6wwu3UGHhTzohhnCcnDp4eqii4kzzD
y37XSqGOaqbhcmg4k9/P9RXB2WhHGbxvDFRD45KLhX6bj/c5oB2BA+ml49DU
fz0NXbmcHa53HB3DnrT5E/53hbqCpL6Cd9RXRSyFPVdGiqGBjo2Hb6GIBNi3
NimHhS6Chv7LPQU0dxJKGGzdVcMuY4sWZr2bjZAZOeAVfeZ1831duRVmSuYG
4FZl/iC0CTUcXAh9OOE/uBUTgw==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"plot\[ScriptCapitalP]\[Xi]", "[", 
   RowBox[{"\[ScriptCapitalP]\[Xi]_", ",", "\[ScriptCapitalT]_", ",", 
    RowBox[{"style_:", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Show", "@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Plot3D", "[", 
      RowBox[{
       RowBox[{"\[ScriptCapitalP]\[Xi]", "[", 
        RowBox[{"[", "t", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "\[Element]", 
        RowBox[{"\[CapitalDelta]", "[", 
         RowBox[{"\[ScriptCapitalT]", ",", "t"}], "]"}]}], ",", 
       RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "style"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", 
       RowBox[{"numbOf\[CapitalDelta]", "@", "\[ScriptCapitalT]"}]}], "}"}]}],
     "]"}]}]}]], "Input",
 CellChangeTimes->{{3.686037191995528*^9, 3.686037194555632*^9}, {
  3.686038255081972*^9, 3.686038262394737*^9}, {3.686038373770032*^9, 
  3.6860384105534105`*^9}, {3.6864007671568427`*^9, 3.686400769737153*^9}, {
  3.686400901109428*^9, 3.6864009460788*^9}, {3.6864010487112975`*^9, 
  3.68640105864292*^9}, {3.6868497657794*^9, 3.6868497799538126`*^9}, {
  3.6872844400755386`*^9, 3.687284448334893*^9}, {3.6872844822957172`*^9, 
  3.687284485113233*^9}, {3.6955539526291933`*^9, 3.695553966078752*^9}, {
  3.695804736615266*^9, 3.695804738553948*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"http", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
        "questions"}], "/", "64366"}], "/", "scale"}], "-", "coloring", "-", 
     "of", "-", "contourplot"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"densityPlot\[ScriptCapitalP]\[Xi]", "[", 
    RowBox[{"\[ScriptCapitalP]\[Xi]_", ",", "\[ScriptCapitalT]_", ",", 
     RowBox[{"{", 
      RowBox[{"min_", ",", "max_"}], "}"}], ",", 
     RowBox[{"cfunc_:", "\"\<DeepSeaColors\>\""}], ",", 
     RowBox[{"showMesh_:", "False"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "plot", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"plot", "=", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"DensityPlot", "[", 
            RowBox[{
             RowBox[{"\[ScriptCapitalP]\[Xi]", "[", 
              RowBox[{"[", "t", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "\[Element]", 
              RowBox[{"\[CapitalDelta]", "[", 
               RowBox[{"\[ScriptCapitalT]", ",", "t"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ColorFunction", "\[Rule]", 
              RowBox[{"ColorData", "[", 
               RowBox[{"{", 
                RowBox[{"cfunc", ",", 
                 RowBox[{"{", 
                  RowBox[{"min", ",", "max"}], "}"}]}], "}"}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{"numbOf\[CapitalDelta]", "@", "\[ScriptCapitalT]"}]}], 
            "}"}]}], "]"}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"showMesh", ",", 
        RowBox[{"Legended", "[", 
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"plot", ",", 
            RowBox[{"highlight", "[", 
             RowBox[{"\[ScriptCapitalT]", ",", 
              RowBox[{"{", "}"}], ",", "0"}], "]"}]}], "]"}], ",", 
          RowBox[{"BarLegend", "[", 
           RowBox[{"{", 
            RowBox[{"cfunc", ",", 
             RowBox[{"{", 
              RowBox[{"min", ",", "max"}], "}"}]}], "}"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"Legended", "[", 
         RowBox[{"plot", ",", 
          RowBox[{"BarLegend", "[", 
           RowBox[{"{", 
            RowBox[{"cfunc", ",", 
             RowBox[{"{", 
              RowBox[{"min", ",", "max"}], "}"}]}], "}"}], "]"}]}], "]"}]}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.693170963934313*^9, 3.6931710278550014`*^9}, {
   3.693171113929119*^9, 3.693171189971552*^9}, {3.6931712392562466`*^9, 
   3.6931712582972608`*^9}, {3.6931712910529346`*^9, 
   3.6931713085737486`*^9}, {3.693171452844756*^9, 3.6931714594804077`*^9}, {
   3.6931717378646927`*^9, 3.6931717391641564`*^9}, {3.693171902541535*^9, 
   3.693171912710541*^9}, {3.693171969567443*^9, 3.693171974301933*^9}, {
   3.693172069432392*^9, 3.6931721431846304`*^9}, {3.6931721740456405`*^9, 
   3.693172174609522*^9}, {3.6931722253254447`*^9, 3.6931722373853507`*^9}, {
   3.693172368377321*^9, 3.6931724033284836`*^9}, {3.6931726649292603`*^9, 
   3.693172700205409*^9}, {3.693172808104412*^9, 3.6931728121115727`*^9}, {
   3.6931729776113925`*^9, 3.693172993203003*^9}, {3.6931730298140945`*^9, 
   3.693173055564917*^9}, {3.6931731117591085`*^9, 3.693173145475483*^9}, {
   3.693173336358453*^9, 3.6931733690728235`*^9}, 3.6931734119187164`*^9, {
   3.6931735435393515`*^9, 3.693173546161483*^9}, {3.693175227079709*^9, 
   3.6931754268298206`*^9}, {3.693176798318146*^9, 3.693176800778298*^9}, {
   3.693178798476668*^9, 3.6931788034241643`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vectorPlot\[ScriptCapitalP]\[Xi]and\[ScriptCapitalP]\[Eta]", "[", 
   RowBox[{
   "\[ScriptCapitalP]\[Xi]_", ",", "\[ScriptCapitalP]\[Eta]_", ",", 
    "\[ScriptCapitalT]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"centroids", "=", 
      RowBox[{"centroids", "@", "\[ScriptCapitalT]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ListVectorPlot", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"centroids", "[", 
           RowBox[{"[", "t", "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[ScriptCapitalP]\[Xi]", "[", 
              RowBox[{"[", "t", "]"}], "]"}], ",", 
             RowBox[{"\[ScriptCapitalP]\[Eta]", "[", 
              RowBox[{"[", "t", "]"}], "]"}]}], "}"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "\[Rule]", 
              RowBox[{"centroids", "[", 
               RowBox[{"[", 
                RowBox[{"t", ",", "1"}], "]"}], "]"}]}], ",", 
             RowBox[{"y", "\[Rule]", 
              RowBox[{"centroids", "[", 
               RowBox[{"[", 
                RowBox[{"t", ",", "2"}], "]"}], "]"}]}]}], "}"}]}]}], 
         "\[IndentingNewLine]", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{"numbOf\[CapitalDelta]", "@", "\[ScriptCapitalT]"}]}], 
         "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"VectorPoints", "\[Rule]", "centroids"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"VectorStyle", "\[Rule]", "Black"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.693177561704209*^9, 3.6931775845117426`*^9}, 
   3.6931776482113075`*^9, {3.693177702239879*^9, 3.6931778183314824`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"computeErrorNorm", "[", 
   RowBox[{"u_", ",", "\[ScriptCapitalP]\[Xi]_", ",", "\[ScriptCapitalT]_"}], 
   "]"}], ":=", 
  RowBox[{"(*", 
   RowBox[{"Sqrt", "@", 
    RowBox[{"Total", "@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Integral]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "\[Element]", 
          RowBox[{"\[CapitalDelta]", "[", 
           RowBox[{"\[ScriptCapitalT]", ",", "t"}], "]"}]}]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "-", 
           RowBox[{"\[ScriptCapitalP]\[Xi]", "[", 
            RowBox[{"[", "t", "]"}], "]"}]}], ")"}], "2"]}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{"numbOf\[CapitalDelta]", "@", "\[ScriptCapitalT]"}]}], 
        "}"}]}], "]"}]}]}], "*)"}], 
  RowBox[{"Sqrt", "@", 
   RowBox[{"Total", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"u", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "-", 
           RowBox[{"\[ScriptCapitalP]\[Xi]", "[", 
            RowBox[{"[", "t", "]"}], "]"}]}], ")"}], "2"], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "\[Element]", 
         RowBox[{"\[CapitalDelta]", "[", 
          RowBox[{"\[ScriptCapitalT]", ",", "t"}], "]"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", 
        RowBox[{"numbOf\[CapitalDelta]", "@", "\[ScriptCapitalT]"}]}], 
       "}"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.686059657370022*^9, 3.686059678117935*^9}, {
  3.686060910555687*^9, 3.6860609639393306`*^9}, {3.686849797255063*^9, 
  3.6868498139690914`*^9}, {3.6957301885359116`*^9, 3.695730201106761*^9}, {
  3.6957306770100837`*^9, 3.6957306774664483`*^9}, {3.6957336270484056`*^9, 
  3.6957336508201942`*^9}, {3.695734195962556*^9, 3.695734206750883*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"computeDOFsNodes", "[", 
    RowBox[{"FE_", ",", "\[ScriptCapitalT]_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"res", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"FE", "[", "\"\<numb of DOFs\>\"", "]"}], "@", 
            "\[ScriptCapitalT]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"res", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"FE", "[", "\"\<DOFs numn\>\"", "]"}], "[", 
            RowBox[{"\[ScriptCapitalT]", ",", "t"}], "]"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"FE", "[", "\"\<DOFs nodes\>\"", "]"}], "[", 
          RowBox[{"\[ScriptCapitalT]", ",", "t"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{"numbOf\[CapitalDelta]", "@", "\[ScriptCapitalT]"}]}], 
         "}"}]}], "]"}], ";", "\[IndentingNewLine]", "res"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.687259002235501*^9, 3.687259051416689*^9}, {
  3.687259134757713*^9, 3.6872592795592756`*^9}, {3.6872593200867977`*^9, 
  3.6872594434059258`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"interpolantOf\[Xi]", "[", 
   RowBox[{"\[Xi]_", ",", "FE_", ",", "\[ScriptCapitalT]_", ",", 
    RowBox[{"order_:", "1"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nodes", ",", "nodes2values"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nodes", "=", 
      RowBox[{"computeDOFsNodes", "[", 
       RowBox[{"FE", ",", "\[ScriptCapitalT]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nodes2values", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"nodes", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"\[Xi]", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "\[Xi]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"nodes2values", ",", 
       RowBox[{"InterpolationOrder", "\[Rule]", "order"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6872594669598303`*^9, 3.6872598412454896`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"convert", " ", "to", " ", "master", " ", "element"}], " ", "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"substMaster", "[", "u_", "]"}], ":=", 
   RowBox[{
    RowBox[{"u", "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        SubscriptBox["x", "4"], "\[Rule]", 
        FractionBox[
         RowBox[{
          SubscriptBox["x", "2"], "+", 
          SubscriptBox["x", "3"]}], "2"]}], ",", 
       RowBox[{
        SubscriptBox["y", "4"], "\[Rule]", 
        FractionBox[
         RowBox[{
          SubscriptBox["y", "2"], "+", 
          SubscriptBox["y", "3"]}], "2"]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["x", "5"], "\[Rule]", 
        FractionBox[
         RowBox[{
          SubscriptBox["x", "1"], "+", 
          SubscriptBox["x", "3"]}], "2"]}], ",", 
       RowBox[{
        SubscriptBox["y", "5"], "\[Rule]", 
        FractionBox[
         RowBox[{
          SubscriptBox["y", "1"], "+", 
          SubscriptBox["y", "3"]}], "2"]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["x", "6"], "\[Rule]", 
        FractionBox[
         RowBox[{
          SubscriptBox["x", "1"], "+", 
          SubscriptBox["x", "2"]}], "2"]}], ",", 
       RowBox[{
        SubscriptBox["y", "6"], "\[Rule]", 
        FractionBox[
         RowBox[{
          SubscriptBox["y", "1"], "+", 
          SubscriptBox["y", "2"]}], "2"]}]}], "\[IndentingNewLine]", "}"}]}], 
    "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["x", "1"], "\[Rule]", "0"}], ",", 
      RowBox[{
       SubscriptBox["y", "1"], "\[Rule]", "0"}], ",", 
      RowBox[{
       SubscriptBox["x", "2"], "\[Rule]", "1"}], ",", 
      RowBox[{
       SubscriptBox["y", "2"], "\[Rule]", "0"}], ",", 
      RowBox[{
       SubscriptBox["x", "3"], "\[Rule]", "0"}], ",", 
      RowBox[{
       SubscriptBox["y", "3"], "\[Rule]", "1"}]}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.689422461972452*^9, 3.6894225344611254`*^9}, {
  3.689425624622954*^9, 3.6894256281941204`*^9}, {3.689426018418332*^9, 
  3.6894260355597477`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"convert", " ", "to", " ", "physical"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"substPhysical", "[", 
    RowBox[{"u_", ",", "\[ScriptCapitalT]_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"u", "/.", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          SubscriptBox["x", "4"], "\[Rule]", 
          FractionBox[
           RowBox[{
            SubscriptBox["x", "2"], "+", 
            SubscriptBox["x", "3"]}], "2"]}], ",", 
         RowBox[{
          SubscriptBox["y", "4"], "\[Rule]", 
          FractionBox[
           RowBox[{
            SubscriptBox["y", "2"], "+", 
            SubscriptBox["y", "3"]}], "2"]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["x", "5"], "\[Rule]", 
          FractionBox[
           RowBox[{
            SubscriptBox["x", "1"], "+", 
            SubscriptBox["x", "3"]}], "2"]}], ",", 
         RowBox[{
          SubscriptBox["y", "5"], "\[Rule]", 
          FractionBox[
           RowBox[{
            SubscriptBox["y", "1"], "+", 
            SubscriptBox["y", "3"]}], "2"]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["x", "6"], "\[Rule]", 
          FractionBox[
           RowBox[{
            SubscriptBox["x", "1"], "+", 
            SubscriptBox["x", "2"]}], "2"]}], ",", 
         RowBox[{
          SubscriptBox["y", "6"], "\[Rule]", 
          FractionBox[
           RowBox[{
            SubscriptBox["y", "1"], "+", 
            SubscriptBox["y", "2"]}], "2"]}]}], "\[IndentingNewLine]", 
        "}"}]}], "/.", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["x", "1"], "\[Rule]", 
         RowBox[{
          RowBox[{"\[ScriptN]", "[", 
           RowBox[{"\[ScriptCapitalT]", ",", "t"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         SubscriptBox["y", "1"], "\[Rule]", 
         RowBox[{
          RowBox[{"\[ScriptN]", "[", 
           RowBox[{"\[ScriptCapitalT]", ",", "t"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         SubscriptBox["x", "2"], "\[Rule]", 
         RowBox[{
          RowBox[{"\[ScriptN]", "[", 
           RowBox[{"\[ScriptCapitalT]", ",", "t"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         SubscriptBox["y", "2"], "\[Rule]", 
         RowBox[{
          RowBox[{"\[ScriptN]", "[", 
           RowBox[{"\[ScriptCapitalT]", ",", "t"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         SubscriptBox["x", "3"], "\[Rule]", 
         RowBox[{
          RowBox[{"\[ScriptN]", "[", 
           RowBox[{"\[ScriptCapitalT]", ",", "t"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         SubscriptBox["y", "3"], "\[Rule]", 
         RowBox[{
          RowBox[{"\[ScriptN]", "[", 
           RowBox[{"\[ScriptCapitalT]", ",", "t"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "2"}], "]"}], "]"}]}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6894256626650667`*^9, 3.6894256889798737`*^9}, {
  3.689425945861698*^9, 3.689426055712123*^9}, {3.689427158454917*^9, 
  3.68942718808296*^9}, {3.689867969951937*^9, 3.6898681084719925`*^9}, {
  3.6898681496056995`*^9, 3.6898682294465756`*^9}, {3.6908009528594294`*^9, 
  3.690800954051779*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1350, 676},
WindowMargins->{{-7, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (February 25, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 172, 3, 144, "Title"],
Cell[755, 27, 113, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[893, 32, 104, 1, 63, "Section"],
Cell[1000, 35, 125, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[1150, 40, 310, 9, 43, "Subsection"],
Cell[1463, 51, 2505, 50, 172, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4005, 106, 257, 8, 43, "Subsection"],
Cell[4265, 116, 4167, 110, 252, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8469, 231, 308, 9, 43, "Subsection"],
Cell[8780, 242, 4298, 106, 202, "Input"],
Cell[13081, 350, 3940, 101, 307, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[17058, 456, 278, 9, 35, "Subsection"],
Cell[17339, 467, 3754, 92, 327, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[21142, 565, 146, 2, 49, "Section"],
Cell[CellGroupData[{
Cell[21313, 571, 101, 1, 43, "Subsection"],
Cell[21417, 574, 6161, 119, 192, "Input"],
Cell[27581, 695, 1179, 32, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28797, 732, 103, 1, 43, "Subsection"],
Cell[28903, 735, 3567, 85, 332, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32507, 825, 112, 1, 43, "Subsection"],
Cell[32622, 828, 2556, 64, 112, "Input"],
Cell[35181, 894, 1383, 31, 52, "Input"],
Cell[36567, 927, 1673, 41, 152, "Input"],
Cell[38243, 970, 6405, 152, 472, "Input"],
Cell[44651, 1124, 1481, 32, 31, "Input"],
Cell[46135, 1158, 4148, 92, 172, "Input"],
Cell[50286, 1252, 1951, 47, 192, "Input"],
Cell[52240, 1301, 2090, 54, 62, "Input"],
Cell[54333, 1357, 1390, 37, 92, "Input"],
Cell[55726, 1396, 1191, 32, 112, "Input"],
Cell[56920, 1430, 2167, 64, 186, "Input"],
Cell[59090, 1496, 3929, 106, 362, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

