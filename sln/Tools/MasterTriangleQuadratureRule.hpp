#pragma once
#include "AbstractQuadratureRule.hpp"

class MasterTriangleQuadratureRule 
	: public AbstractQuadratureRule<2, 3> {
	// singleton
	MasterTriangleQuadratureRule() : AbstractQuadratureRule {
		// (1) element (master triangle)
		{ { {0., 0.}, {1., 0.}, {0., 1.} } },
		// (2) nodes (n := polynomial order)
		{
			{ // n = 0
				{ 1/3., 1/3. }
			},
			{ // n = 1
				{ 1/3., 1/3. } 
			}, 
			{ // n = 2
				{ 1/6., 1/6. }, 
				{ 2/3., 1/6. }, 
				{ 1/6., 2/3. } 
			}, 
			{ // n = 3
				{ 1/3., 1/3. }, 
				{ 1/5., 1/5. }, 
				{ 1/5., 3/5. }, 
				{ 3/5., 1/5.} 
			}, 
			{ // n = 4
				{ .44594849091597, .44594849091597 },
				{ .44594849091597, .10810301816807 },
				{ .10810301816807, .44594849091597 },
				{ .09157621350977, .09157621350977 },
				{ .09157621350977, .81684757298046 },
				{ .81684757298046, .09157621350977 }
			}, 
			{ // n = 5
				{ .33333333333333, .33333333333333 },
				{ .47014206410511, .47014206410511 },
				{ .47014206410511, .05971587178977 },
				{ .05971587178977, .47014206410511 },
				{ .10128650732346, .10128650732346 },
				{ .10128650732346, .79742698535309 },
				{ .79742698535309, .10128650732346 }
			},
			{ // n = 6
				{ .24928674517091, .24928674517091 },
				{ .24928674517091, .50142650965818 },
				{ .50142650965818, .24928674517091 },
				{ .06308901449150, .06308901449150 },
				{ .06308901449150, .87382197101700 },
				{ .87382197101700, .06308901449150 },
				{ .31035245103378, .63650249912140 },
				{ .63650249912140, .05314504984482 },
				{ .05314504984482, .31035245103378 },
				{ .63650249912140, .31035245103378 },
				{ .31035245103378, .05314504984482 },
				{ .05314504984482, .63650249912140 }
			}
		},
		{ // weights
			// n = 0
			{ 1/2. },
			// n = 1
			{ 1/2. },
			// n = 2
			{ 1/6., 1/6., 1/6. },
			// n = 3
			{ -27/96., 25/96., 25/96., 25/96. },
			// n = 4
			{ .111690794839005, .111690794839005, .111690794839005, .05497587182766, .05497587182766, .05497587182766 },
			// n = 5
			{ .112500000000000, .066197076394255, .066197076394255, .066197076394255, .062969590272415, .062969590272415, .062969590272415 },
			// n = 6
			{ .05839313786319, .05839313786319, .05839313786319, .025422453185105, .025422453185105, .025422453185105, .041425537809185, .041425537809185, .041425537809185, .041425537809185, .041425537809185, .041425537809185 }
		}
	}
	{}
	MasterTriangleQuadratureRule(MasterTriangleQuadratureRule const &);
	MasterTriangleQuadratureRule& operator=(MasterTriangleQuadratureRule const &);
public:
	static auto& instance() {
		static MasterTriangleQuadratureRule single;
		return single;
	}
};